<VirtualHost *:80>
    # Define ServerName and document root
    ServerName localhost
    DocumentRoot /app/web

    # Default file to serve if no file is provided
    DirectoryIndex index.php

    # Directory-specific settings
    <Directory /app/web>
        Options FollowSymLinks
        AllowOverride All  # Enable .htaccess
        Require all granted
    </Directory>

    # Force HTTPS (Heroku-specific logic)
    <IfModule mod_rewrite.c>
        RewriteEngine On
        RewriteCond %{HTTP:X-Forwarded-Proto} !https
        RewriteRule ^ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]
    </IfModule>

    # Logging for debugging and monitoring
    ErrorLog /app/storage/logs/apache_error.log
    CustomLog /app/storage/logs/apache_access.log combined

    # PHP-specific settings (use if mod_php is active; not PHP-FPM)
    <IfModule mod_php.c>
        php_flag display_errors off
        php_value max_execution_time 30
        php_value memory_limit 128M
        php_value post_max_size 8M
        php_value upload_max_filesize 8M
    </IfModule>
</VirtualHost>
